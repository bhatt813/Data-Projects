"0","Sale_Campaign <- dbGetQuery(db, "
"0","""SELECT a.user_id, a.sales_id, a.sale_dt AS sale_date, a.amount, b.campaign, b.created_on AS campaign_dt"
"0","FROM attribution b"
"0","JOIN user_device d on b.device_id = d.device_id"
"0","JOIN (SELECT a.user_id, a.created_on as sale_dt, a.id AS sales_id,a.amount "
"0","  FROM sale a "
"0","  GROUP BY 1,2,3,4) a ON a.user_id = d.user_id"
"0","GROUP BY 1,2,3,4,5,6"")"
"0","Sale_Campaign$campaign_dt<- as.Date(Sale_Campaign$campaign_dt, '%m/%d/%y %H:%M')"
"0","Sale_Campaign$sale_date <- as.Date(Sale_Campaign$sale_date, '%Y-%m-%d %H:%M:%OS')"
"0","Sale_Campaign$days_to_sale <- Sale_Campaign$sale_date - Sale_Campaign$campaign_dt"
"0","Sale_Campaign <- subset(Sale_Campaign, Sale_Campaign$days_to_sale >= 0)"
"0","Sale_Campaign %>% group_by(campaign) %>% summarise(mean = mean(days_to_sale), median = median(days_to_sale), min(days_to_sale), max(days_to_sale)) %>% arrange((mean))"
