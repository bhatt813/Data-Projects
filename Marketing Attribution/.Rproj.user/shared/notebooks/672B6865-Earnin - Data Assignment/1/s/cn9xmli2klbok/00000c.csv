"0","Find_All <- dbGetQuery(db, "
"0","""SELECT DISTINCT b.user_id, min(a.created_on) AS ft_campaign, a.campaign "
"0","  FROM attribution a"
"0","  JOIN user_device b ON b.device_id = a.device_id"
"0","  JOIN (SELECT b.user_id, min(a.created_on) AS ft_date"
"0","        FROM attribution a"
"0","        JOIN user_device b ON b.device_id = a.device_id"
"0","        GROUP BY 1) c ON c.user_id = b.user_id"
"0","WHERE a.created_on <= c.ft_date"
"0","GROUP BY 1,3"
"0",""")"
"0","Find <- dbGetQuery(db, "
"0","""SELECT DISTINCT b.user_id, min(a.created_on) AS ft_campaign, a.campaign "
"0","  FROM attribution a"
"0","  JOIN user_device b ON b.device_id = a.device_id"
"0","  JOIN (SELECT b.user_id, min(a.created_on) AS ft_date"
"0","        FROM attribution a"
"0","        JOIN user_device b ON b.device_id = a.device_id"
"0","        GROUP BY 1) c ON c.user_id = b.user_id"
"0","  JOIN device d ON d.id = b.device_id"
"0","WHERE a.created_on <= c.ft_date"
"0","AND d.created_on > c.ft_date"
"0","GROUP BY 1,3"
"0",""")"
